<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>‡§ï‡•ç‡§µ‡§ø‡§ú ‡§™‡•ç‡§≤‡•á‡§ü‡§´‡•â‡§∞‡•ç‡§Æ - ‡§¶‡•à‡§®‡§ø‡§ï ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§î‡§∞ ‡§∏‡•Å‡§ú‡§∏ ‡§ï‡•ç‡§µ‡§ø‡§ú</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Nirmala UI', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        body {
            background: linear-gradient(145deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: clamp(10px, 3vw, 20px);
        }
        .container {
            max-width: min(1100px, 95%);
            margin: 0 auto;
        }
        .header {
            background: white;
            color: #333;
            padding: clamp(15px, 4vw, 30px);
            border-radius: 25px 25px 0 0;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        .header h1 {
            font-size: clamp(1.5rem, 5vw, 2.2rem);
            margin-bottom: 10px;
            background: linear-gradient(145deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            word-break: break-word;
        }
        .mode-badge {
            display: inline-block;
            padding: clamp(5px, 2vw, 8px) clamp(15px, 4vw, 25px);
            border-radius: 40px;
            font-size: clamp(0.85rem, 2.5vw, 1rem);
            font-weight: 600;
            margin: 10px 0;
        }
        .mode-badge.dainik {
            background: #28a745;
            color: white;
        }
        .mode-badge.sujas {
            background: #ffc107;
            color: #000;
        }
        
        /* Quiz Type Selector Popup */
        .quiz-type-popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 3000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .quiz-type-popup.active {
            display: flex;
        }
        .popup-content {
            background: white;
            border-radius: 30px;
            width: min(400px, 95%);
            padding: clamp(25px, 5vw, 35px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease;
        }
        .popup-content h2 {
            color: #333;
            margin-bottom: 25px;
            text-align: center;
            font-size: clamp(1.3rem, 4vw, 1.8rem);
        }
        .quiz-type-option {
            background: #f8f9fa;
            border: 3px solid #e0e0e0;
            border-radius: 20px;
            padding: clamp(20px, 4vw, 25px);
            margin-bottom: 15px;
            cursor: pointer;
            transition: 0.2s;
            text-align: center;
        }
        .quiz-type-option:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            border-color: #667eea;
        }
        .quiz-type-option:active {
            transform: translateY(0);
        }
        .quiz-type-option h3 {
            font-size: clamp(1.2rem, 3.5vw, 1.5rem);
            margin-bottom: 8px;
            color: #333;
        }
        .quiz-type-option p {
            color: #666;
            font-size: clamp(0.9rem, 2.5vw, 1rem);
        }
        .dainik-option {
            border-left: 8px solid #28a745;
        }
        .sujas-option {
            border-left: 8px solid #ffc107;
        }
        .close-popup {
            text-align: center;
            margin-top: 15px;
            padding: 10px;
            color: #666;
            cursor: pointer;
            font-size: 0.9rem;
        }
        .close-popup:hover {
            color: #333;
        }

        /* Quiz Type Header */
        .quiz-type-header {
            background: white;
            padding: clamp(15px, 3vw, 20px);
            border-radius: 15px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .quiz-type-badge {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: clamp(1rem, 2.8vw, 1.2rem);
            font-weight: 600;
            padding: clamp(8px, 2vw, 10px) clamp(15px, 3vw, 20px);
            border-radius: 40px;
            cursor: pointer;
            transition: 0.2s;
        }
        .quiz-type-badge.dainik {
            background: #28a745;
            color: white;
        }
        .quiz-type-badge.sujas {
            background: #ffc107;
            color: #000;
        }
        .quiz-type-badge:hover {
            transform: scale(1.05);
        }

        .admin-section {
            background: white;
            padding: clamp(15px, 3vw, 20px);
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .admin-login {
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
        }
        .admin-login input {
            padding: clamp(10px, 2.5vw, 12px) clamp(15px, 3vw, 20px);
            border: 2px solid #e0e0e0;
            border-radius: 40px;
            font-size: clamp(0.9rem, 2.5vw, 1rem);
            width: min(250px, 80%);
        }
        .btn {
            padding: clamp(10px, 2.5vw, 12px) clamp(15px, 3vw, 20px);
            border: none;
            border-radius: 50px;
            font-size: clamp(0.9rem, 2.5vw, 1rem);
            font-weight: 600;
            cursor: pointer;
            transition: 0.2s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin: 5px;
        }
        .btn-primary {
            background: linear-gradient(145deg, #667eea, #764ba2);
            color: white;
        }
        .btn-success {
            background: #28a745;
            color: white;
        }
        .btn-info {
            background: #17a2b8;
            color: white;
        }
        .btn-warning {
            background: #ffc107;
            color: #000;
        }
        
        .generate-section {
            background: white;
            padding: clamp(20px, 4vw, 30px);
            border-radius: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        .json-input {
            width: 100%;
            min-height: min(200px, 40vh);
            padding: clamp(12px, 3vw, 18px);
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            font-family: monospace;
            font-size: clamp(0.85rem, 2.5vw, 0.95rem);
            margin-bottom: 20px;
            resize: vertical;
        }
        .share-section {
            background: white;
            padding: clamp(20px, 4vw, 30px);
            border-radius: 25px;
            margin: 25px 0;
            border: 3px dashed #667eea;
        }
        .share-box {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        .share-input {
            flex: 1;
            min-width: min(280px, 100%);
            padding: clamp(12px, 2.5vw, 15px) clamp(15px, 3vw, 20px);
            border: 2px solid #dee2e6;
            border-radius: 50px;
            font-size: clamp(0.9rem, 2.5vw, 1rem);
            background: #f8f9fa;
        }
        .quiz-container {
            background: white;
            border-radius: 25px;
            padding: clamp(20px, 4vw, 30px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }
        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 18px;
            border-bottom: 2px solid #f0f0f0;
            flex-wrap: wrap;
            gap: 12px;
        }
        .question-count {
            background: #ffc107;
            color: #000;
            padding: clamp(6px, 1.5vw, 8px) clamp(15px, 3vw, 22px);
            border-radius: 40px;
            font-weight: 600;
            font-size: clamp(0.9rem, 2.5vw, 1rem);
        }
        
        /* Date Display Box */
        .date-display-box {
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            border-radius: 60px;
            padding: clamp(12px, 2.5vw, 15px) clamp(20px, 4vw, 25px);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
            border: 2px solid #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
            cursor: pointer;
            transition: 0.2s;
        }
        .date-display-box:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }
        .current-date {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: clamp(1.1rem, 3vw, 1.3rem);
            font-weight: 600;
            color: #333;
        }
        .current-date span:first-child {
            background: linear-gradient(145deg, #667eea, #764ba2);
            color: white;
            padding: clamp(8px, 1.5vw, 10px) clamp(15px, 3vw, 20px);
            border-radius: 40px;
            font-size: clamp(0.9rem, 2.5vw, 1rem);
        }
        .calendar-icon {
            background: white;
            width: clamp(40px, 8vw, 45px);
            height: clamp(40px, 8vw, 45px);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(1.2rem, 3vw, 1.5rem);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        /* Modal Calendar */
        .calendar-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .calendar-modal.active {
            display: flex;
        }
        .calendar-modal-content {
            background: white;
            border-radius: 30px;
            width: min(450px, 95%);
            max-height: 90vh;
            overflow-y: auto;
            padding: clamp(20px, 4vw, 25px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease;
        }
        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 0 5px;
        }
        .calendar-header h3 {
            color: #333;
            font-size: clamp(1.2rem, 4vw, 1.4rem);
            font-weight: 600;
        }
        .calendar-nav {
            display: flex;
            gap: 10px;
        }
        .calendar-nav button {
            background: #f0f0f0;
            border: none;
            width: clamp(35px, 7vw, 40px);
            height: clamp(35px, 7vw, 40px);
            border-radius: 50%;
            font-size: clamp(1.1rem, 3vw, 1.3rem);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.2s;
            color: #667eea;
        }
        .calendar-nav button:hover {
            background: #e0e0e0;
        }
        .weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            text-align: center;
            font-weight: 600;
            color: #666;
            margin-bottom: 10px;
            padding: 5px 0;
            font-size: clamp(0.8rem, 2.2vw, 0.9rem);
        }
        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: clamp(3px, 1vw, 5px);
            margin-bottom: 20px;
        }
        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: clamp(8px, 2vw, 12px);
            cursor: pointer;
            transition: 0.2s;
            font-weight: 300;
            background: #f8f9fa;
            padding: 1px;
        }
        .calendar-day:hover {
            background: #e9ecef;
            transform: scale(1.05);
        }
        .calendar-day.selected {
            background: linear-gradient(145deg, #667eea, #764ba2);
            color: white;
        }
        .calendar-day.has-quiz {
            border: 2px solid #28a745;
        }
        .calendar-day.has-quiz.selected {
            border: 2px solid white;
        }
        .calendar-day.empty {
            background: none;
            cursor: default;
        }
        .day-number {
            font-size: clamp(0.9rem, 2.5vw, 1rem);
            font-weight: 600;
        }
        .quiz-indicator {
            font-size: clamp(0.6rem, 1.5vw, 0.7rem);
            margin-top: 2px;
            color: #28a745;
        }
        .calendar-day.selected .quiz-indicator {
            color: white;
        }
        .calendar-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 2px solid #f0f0f0;
        }
        .calendar-actions button {
            padding: clamp(8px, 2vw, 10px) clamp(15px, 3vw, 20px);
            border: none;
            border-radius: 40px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.2s;
        }
        .calendar-actions .confirm {
            background: linear-gradient(145deg, #667eea, #764ba2);
            color: white;
        }
        .calendar-actions .cancel {
            background: #f0f0f0;
            color: #666;
        }
        
        /* Questions */
        .question-item {
            background: #f8f9fa;
            border-radius: clamp(15px, 3vw, 18px);
            padding: clamp(18px, 3vw, 22px);
            margin-bottom: 22px;
            border-left: 6px solid #667eea;
        }
        .question-item.sujas {
            border-left: 6px solid #ffc107;
        }
        .category-tag {
            display: inline-block;
            background: #6c757d;
            color: white;
            padding: clamp(4px, 1.2vw, 5px) clamp(12px, 2.5vw, 18px);
            border-radius: 30px;
            font-size: clamp(0.75rem, 2vw, 0.85rem);
            margin-bottom: 12px;
        }
        .question-text {
            font-size: clamp(1rem, 3vw, 1.2rem);
            font-weight: 600;
            color: #333;
            margin-bottom: 18px;
        }
        .options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(min(220px, 100%), 1fr));
            gap: 12px;
            margin: 18px 0;
        }
        .option {
            background: white;
            padding: clamp(12px, 2.5vw, 14px) clamp(15px, 3vw, 20px);
            border-radius: 12px;
            border: 2px solid #dee2e6;
            cursor: pointer;
            transition: 0.2s;
            font-size: clamp(0.9rem, 2.5vw, 1rem);
        }
        .option:hover {
            background: #e9ecef;
            border-color: #667eea;
        }
        .option.selected-correct {
            background: #d4edda;
            border-color: #28a745;
        }
        .option.selected-wrong {
            background: #f8d7da;
            border-color: #dc3545;
        }
        .explanation {
            margin-top: 18px;
            padding: clamp(15px, 3vw, 18px);
            background: #e9ecef;
            border-radius: 12px;
            display: none;
        }
        .explanation.show {
            display: block;
        }
        .loading {
            text-align: center;
            padding: clamp(30px, 8vw, 50px);
        }
        .spinner {
            width: clamp(40px, 10vw, 60px);
            height: clamp(40px, 10vw, 60px);
            border: 6px solid #f3f3f3;
            border-top: 6px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .copy-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: clamp(10px, 2.5vw, 12px) clamp(15px, 3vw, 25px);
            border-radius: 50px;
            animation: slideIn 0.3s ease;
            z-index: 1000;
        }
        .footer {
            text-align: center;
            margin-top: 25px;
            color: white;
            font-size: clamp(0.8rem, 2.2vw, 0.9rem);
        }
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: clamp(20px, 5vw, 30px);
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
        }

        /* Admin Modal */
        .admin-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1500;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .admin-modal.active {
            display: flex;
        }
        .admin-modal-content {
            background: white;
            padding: clamp(20px, 5vw, 30px);
            border-radius: 25px;
            max-width: 400px;
            width: 100%;
            text-align: center;
        }
        .admin-modal-content h3 {
            margin-bottom: 20px;
            color: #333;
            font-size: clamp(1.2rem, 4vw, 1.5rem);
        }
        .admin-modal-content input {
            width: 100%;
            padding: clamp(12px, 3vw, 15px);
            border: 2px solid #e0e0e0;
            border-radius: 40px;
            margin-bottom: 20px;
            font-size: clamp(0.9rem, 2.5vw, 1rem);
        }
        .admin-modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .json-editor-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 12px;
        }

        @media (max-width: 480px) {
            .date-display-box {
                flex-direction: column;
                text-align: center;
            }
            .current-date {
                flex-direction: column;
            }
            .calendar-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üìö ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§™‡•ç‡§≤‡•á‡§ü‡§´‡•â‡§∞‡•ç‡§Æ</h1>
            <p>‡§¶‡•à‡§®‡§ø‡§ï ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§î‡§∞ ‡§∏‡•Å‡§ú‡§∏ ‡§ï‡•ç‡§µ‡§ø‡§ú</p>
            <div id="quizTypeBadge" class="mode-badge dainik">üìÖ ‡§¶‡•à‡§®‡§ø‡§ï ‡§ï‡•ç‡§µ‡§ø‡§ú</div>
        </div>

        <!-- Quiz Type Selector Popup -->
        <div class="quiz-type-popup" id="quizTypePopup">
            <div class="popup-content">
                <h2>üìã ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§ö‡•Å‡§®‡•á‡§Ç</h2>
                <div class="quiz-type-option dainik-option" onclick="selectQuizType('dainik')">
                    <h3>üìÖ ‡§¶‡•à‡§®‡§ø‡§ï ‡§ï‡•ç‡§µ‡§ø‡§ú</h3>
                    <p>‡§∞‡•ã‡§ú‡§æ‡§®‡§æ ‡§ï‡§∞‡§Ç‡§ü ‡§Ö‡§´‡•á‡§Ø‡§∞‡•ç‡§∏ ‡§™‡§∞ ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§ï‡•ç‡§µ‡§ø‡§ú</p>
                </div>
                <div class="quiz-type-option sujas-option" onclick="selectQuizType('sujas')">
                    <h3>‚ú® ‡§∏‡•Å‡§ú‡§∏ ‡§ï‡•ç‡§µ‡§ø‡§ú</h3>
                    <p>‡§µ‡§ø‡§∂‡•á‡§∑ ‡§µ‡§ø‡§∑‡§Ø‡•ã‡§Ç ‡§™‡§∞ ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§ï‡•ç‡§µ‡§ø‡§ú</p>
                </div>
                <div class="close-popup" onclick="closeQuizTypePopup()">‚úñ ‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</div>
            </div>
        </div>

        <!-- Quiz Type Header -->
        <div class="quiz-type-header">
            <div id="quizTypeSelector" class="quiz-type-badge dainik" onclick="openQuizTypePopup()">
                <span id="quizTypeText">üìÖ ‡§¶‡•à‡§®‡§ø‡§ï ‡§ï‡•ç‡§µ‡§ø‡§ú</span>
                <span>‚ñº</span>
            </div>
            <div>
                <span id="sourceBadge"></span>
            </div>
        </div>

        <!-- Admin Login Section -->
        <div class="admin-section" id="adminSection">
            <div id="adminLoginForm" class="admin-login">
                <input type="password" id="adminPassword" placeholder="‡§è‡§°‡§Æ‡§ø‡§® ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§°‡§æ‡§≤‡•á‡§Ç">
                <button class="btn btn-primary" onclick="openAdminModal()">üîë ‡§è‡§°‡§Æ‡§ø‡§® ‡§≤‡•â‡§ó‡§ø‡§®</button>
            </div>
            <div id="adminControls" style="display: none;">
                <button class="btn btn-primary" onclick="showEditMode()">‚úèÔ∏è ‡§è‡§°‡§ø‡§ü ‡§Æ‡•ã‡§° ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§è‡§Ç</button>
                <button class="btn btn-info" onclick="logoutAdmin()">üö™ ‡§≤‡•â‡§ó‡§Ü‡§â‡§ü</button>
            </div>
        </div>

        <!-- Generate Section (Edit Mode) -->
        <div id="generateSection" class="generate-section" style="display: none;">
            <h3 style="color: #333; margin-bottom: 15px;">üìù ‡§®‡§Ø‡§æ ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§¨‡§®‡§æ‡§è‡§Ç / ‡§è‡§°‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç</h3>
            
            <div style="margin-bottom: 20px; display: flex; gap: 15px; flex-wrap: wrap;">
                <div>
                    <label style="font-weight: 600; color: #333;">üìÖ ‡§§‡§æ‡§∞‡•Ä‡§ñ:</label>
                    <input type="date" id="quizDateInput" style="padding: 12px; border-radius: 10px; border: 2px solid #e0e0e0; margin-left: 10px;">
                </div>
                <div>
                    <label style="font-weight: 600; color: #333;">üìã ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞:</label>
                    <select id="editQuizType" style="padding: 12px; border-radius: 10px; border: 2px solid #e0e0e0; margin-left: 10px;">
                        <option value="dainik">‡§¶‡•à‡§®‡§ø‡§ï ‡§ï‡•ç‡§µ‡§ø‡§ú</option>
                        <option value="sujas">‡§∏‡•Å‡§ú‡§∏ ‡§ï‡•ç‡§µ‡§ø‡§ú</option>
                    </select>
                </div>
            </div>

            <div class="json-editor-actions">
                <button class="btn btn-primary" onclick="saveQuizToJSONBin()">üíæ ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç</button>
                <button class="btn btn-warning" onclick="editJSON()">‚úèÔ∏è JSON ‡§è‡§°‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç</button>
                <button class="btn btn-info" onclick="loadSampleJSON()">üìã ‡§∏‡•à‡§Ç‡§™‡§≤ JSON</button>
                <button class="btn btn-success" onclick="formatJSON()">üîß JSON ‡§´‡•â‡§∞‡•ç‡§Æ‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç</button>
            </div>
            
            <textarea id="jsonInput" class="json-input" placeholder='‡§Ø‡§π‡§æ‡§Å JSON ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç...' readonly></textarea>
            <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                ‚ÑπÔ∏è JSON ‡§è‡§°‡§ø‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡§π‡§≤‡•á "JSON ‡§è‡§°‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç" ‡§¨‡§ü‡§® ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç
            </div>
        </div>

        <!-- Share Section -->
        <div id="shareSection" class="share-section" style="display: none;">
            <h3 style="color: #333;">üîó ‡§Ø‡§π ‡§≤‡§ø‡§Ç‡§ï ‡§∂‡•á‡§Ø‡§∞ ‡§ï‡§∞‡•á‡§Ç</h3>
            <div class="quiz-id-box">Quiz ID: <span id="quizId"></span></div>
            <div class="share-box">
                <input type="text" id="shareUrl" class="share-input" readonly>
                <button class="btn btn-success" onclick="copyShareUrl()">üìã ‡§ï‡•â‡§™‡•Ä ‡§ï‡§∞‡•á‡§Ç</button>
            </div>
        </div>

        <!-- Quiz Container -->
        <div class="quiz-container">
            <div class="quiz-header">
                <div>
                    <span id="quizDate" style="margin-left: 10px;"></span>
                </div>
                <span class="question-count" id="questionCount">0 ‡§™‡•ç‡§∞‡§∂‡•ç‡§®</span>
            </div>

            <!-- Date Display Box -->
            <div class="date-display-box" onclick="openCalendarModal()">
                <div class="current-date">
                    <span id="dateLabel">üìÖ ‡§Ü‡§ú ‡§ï‡•Ä ‡§§‡§æ‡§∞‡•Ä‡§ñ</span>
                    <span id="selectedDateDisplay">25 February 2026</span>
                </div>
                <div class="calendar-icon">üìÜ</div>
            </div>
            
            <div id="questionsList">
                <div class="loading">
                    <div class="spinner"></div>
                    <div>‚è≥ ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>üìå ‡§∞‡•ã‡§ú‡§æ‡§®‡§æ ‡§®‡§Ø‡§æ ‡§ï‡•ç‡§µ‡§ø‡§ú - ‡§π‡§∞ ‡§¶‡§ø‡§® ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§ï‡•Å‡§õ ‡§®‡§Ø‡§æ</p>
        </div>
    </div>

    <!-- Calendar Modal -->
    <div class="calendar-modal" id="calendarModal">
        <div class="calendar-modal-content">
            <div class="calendar-header">
                <h3 id="modalCalendarMonthYear">‡§´‡§∞‡§µ‡§∞‡•Ä 2026</h3>
                <div class="calendar-nav">
                    <button onclick="changeModalMonth(-1)">‚Üê</button>
                    <button onclick="changeModalMonth(1)">‚Üí</button>
                </div>
            </div>
            
            <div class="weekdays">
                <span>‡§∏‡•ã‡§Æ</span>
                <span>‡§Æ‡§Ç‡§ó‡§≤</span>
                <span>‡§¨‡•Å‡§ß</span>
                <span>‡§ó‡•Å‡§∞‡•Å</span>
                <span>‡§∂‡•Å‡§ï‡•ç‡§∞</span>
                <span>‡§∂‡§®‡§ø</span>
                <span>‡§∞‡§µ‡§ø</span>
            </div>
            
            <div class="calendar-days" id="modalCalendarDays"></div>
            
            <div class="calendar-actions">
                <button class="cancel" onclick="closeCalendarModal()">‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</button>
                <button class="confirm" onclick="confirmDateSelection()">‡§ö‡•Å‡§®‡•á‡§Ç</button>
            </div>
        </div>
    </div>

    <!-- Admin Modal -->
    <div class="admin-modal" id="adminModal">
        <div class="admin-modal-content">
            <h3>üîê ‡§è‡§°‡§Æ‡§ø‡§® ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°</h3>
            <input type="password" id="modalPassword" placeholder="‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§°‡§æ‡§≤‡•á‡§Ç">
            <div class="admin-modal-buttons">
                <button class="btn btn-primary" onclick="verifyAdmin()">‡§≤‡•â‡§ó‡§ø‡§®</button>
                <button class="btn btn-info" onclick="closeAdminModal()">‡§ï‡•à‡§Ç‡§∏‡§≤</button>
            </div>
        </div>
    </div>

    <script>
        const JSONBIN_CONFIG = {
            masterKey: '$2a$10$XL4iuq0g8lswBdQN2KIhh.QodRh.0QEmO0nxno45VV3DR14ZVmzkK',
            masterBinId: '6997e25cd0ea881f40c8983b',
            sujasMasterBinId: '67df8a2b8a456b79667f1e97',
            apiUrl: 'https://api.jsonbin.io/v3',
            adminPassword: 'admin@123'
        };

        const defaultQuiz = {
            quiz: [
                {
                    question: "‡§π‡§æ‡§≤ ‡§π‡•Ä ‡§Æ‡•á‡§Ç ‡§∞‡§æ‡§ú‡§∏‡•ç‡§•‡§æ‡§® ‡§∏‡§∞‡§ï‡§æ‡§∞ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡•Ä ‡§ó‡§à '‡§Æ‡•Å‡§ñ‡•ç‡§Ø‡§Æ‡§Ç‡§§‡•ç‡§∞‡•Ä ‡§Ö‡§®‡•ç‡§®‡§™‡•Ç‡§∞‡•ç‡§£‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ' ‡§ï‡•á ‡§§‡§π‡§§ ‡§≠‡•ã‡§ú‡§® ‡§ï‡•Ä ‡§ï‡•Ä‡§Æ‡§§ ‡§ï‡§ø‡§§‡§®‡•Ä ‡§π‡•à?",
                    options: ["‚Çπ8", "‚Çπ10", "‚Çπ12", "‚Çπ15"],
                    correct: 0,
                    explanation: "‡§Æ‡•Å‡§ñ‡•ç‡§Ø‡§Æ‡§Ç‡§§‡•ç‡§∞‡•Ä ‡§Ö‡§®‡•ç‡§®‡§™‡•Ç‡§∞‡•ç‡§£‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ ‡§ï‡•á ‡§§‡§π‡§§ ‡§∞‡§æ‡§ú‡§∏‡•ç‡§•‡§æ‡§® ‡§∏‡§∞‡§ï‡§æ‡§∞ ‡§ó‡§∞‡•Ä‡§¨‡•ã‡§Ç ‡§ï‡•ã ‚Çπ8 ‡§Æ‡•á‡§Ç ‡§≠‡•ã‡§ú‡§® ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§ï‡§∞‡§æ ‡§∞‡§π‡•Ä ‡§π‡•à‡•§",
                    category: "‡§∞‡§æ‡§ú‡§∏‡•ç‡§•‡§æ‡§® ‡§Ø‡•ã‡§ú‡§®‡§æ‡§è‡§Ç"
                }
            ]
        };

        const defaultSujasQuiz = {
            quiz: [
                {
                    question: "‡§∏‡•Å‡§ú‡§∏ ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§ï‡§æ ‡§™‡§π‡§≤‡§æ ‡§∏‡§µ‡§æ‡§≤ - ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§® ‡§î‡§∞ ‡§§‡§ï‡§®‡•Ä‡§ï",
                    options: ["‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ 1", "‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ 2", "‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ 3", "‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ 4"],
                    correct: 1,
                    explanation: "‡§Ø‡§π ‡§∏‡•Å‡§ú‡§∏ ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§ï‡§æ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§∏‡§µ‡§æ‡§≤ ‡§π‡•à‡•§",
                    category: "‡§∏‡•Å‡§ú‡§∏ ‡§∏‡•ç‡§™‡•á‡§∂‡§≤"
                }
            ]
        };

        let currentQuiz = [];
        let userAnswers = [];
        let dateBinMap = {};
        let sujasDateBinMap = {};
        let allBins = [];
        let sujasAllBins = [];
        let currentModalDate = new Date();
        let selectedDate = new Date();
        let isAdmin = false;
        let currentQuizType = 'dainik';

        async function initialize() {
            await loadAllBins();
            
            // Set current date
            const today = new Date();
            selectedDate = new Date(today);
            currentModalDate = new Date(today);
            
            updateSelectedDateDisplay();
            renderModalCalendar();
            
            // Load today's quiz based on current type
            loadQuizForSelectedDate();
        }

        function formatDate(date) {
            return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
        }

        function updateSelectedDateDisplay() {
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('selectedDateDisplay').textContent = 
                selectedDate.toLocaleDateString('hi-IN', options);
        }

        // Quiz Type Functions
        function openQuizTypePopup() {
            document.getElementById('quizTypePopup').classList.add('active');
        }

        function closeQuizTypePopup() {
            document.getElementById('quizTypePopup').classList.remove('active');
        }

        function selectQuizType(type) {
            currentQuizType = type;
            const badge = document.getElementById('quizTypeSelector');
            const badgeText = document.getElementById('quizTypeText');
            const mainBadge = document.getElementById('quizTypeBadge');
            const dateLabel = document.getElementById('dateLabel');
            
            if (type === 'dainik') {
                badge.className = 'quiz-type-badge dainik';
                badgeText.innerHTML = 'üìÖ ‡§¶‡•à‡§®‡§ø‡§ï ‡§ï‡•ç‡§µ‡§ø‡§ú';
                mainBadge.className = 'mode-badge dainik';
                mainBadge.innerHTML = 'üìÖ ‡§¶‡•à‡§®‡§ø‡§ï ‡§ï‡•ç‡§µ‡§ø‡§ú';
                dateLabel.innerHTML = 'üìÖ ‡§¶‡•à‡§®‡§ø‡§ï ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§§‡§æ‡§∞‡•Ä‡§ñ';
            } else {
                badge.className = 'quiz-type-badge sujas';
                badgeText.innerHTML = '‚ú® ‡§∏‡•Å‡§ú‡§∏ ‡§ï‡•ç‡§µ‡§ø‡§ú';
                mainBadge.className = 'mode-badge sujas';
                mainBadge.innerHTML = '‚ú® ‡§∏‡•Å‡§ú‡§∏ ‡§ï‡•ç‡§µ‡§ø‡§ú';
                dateLabel.innerHTML = 'üìÖ ‡§∏‡•Å‡§ú‡§∏ ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§§‡§æ‡§∞‡•Ä‡§ñ';
            }
            
            closeQuizTypePopup();
            renderModalCalendar();
            loadQuizForSelectedDate();
        }

        // Calendar Modal Functions
        function openCalendarModal() {
            document.getElementById('calendarModal').classList.add('active');
            renderModalCalendar();
        }

        function closeCalendarModal() {
            document.getElementById('calendarModal').classList.remove('active');
        }

        function renderModalCalendar() {
            const year = currentModalDate.getFullYear();
            const month = currentModalDate.getMonth();
            
            const monthNames = ['‡§ú‡§®‡§µ‡§∞‡•Ä', '‡§´‡§∞‡§µ‡§∞‡•Ä', '‡§Æ‡§æ‡§∞‡•ç‡§ö', '‡§Ö‡§™‡•ç‡§∞‡•à‡§≤', '‡§Æ‡§à', '‡§ú‡•Ç‡§®',
                '‡§ú‡•Å‡§≤‡§æ‡§à', '‡§Ö‡§ó‡§∏‡•ç‡§§', '‡§∏‡§ø‡§§‡§Ç‡§¨‡§∞', '‡§Ö‡§ï‡•ç‡§ü‡•Ç‡§¨‡§∞', '‡§®‡§µ‡§Ç‡§¨‡§∞', '‡§¶‡§ø‡§∏‡§Ç‡§¨‡§∞'];
            
            document.getElementById('modalCalendarMonthYear').textContent = 
                `${monthNames[month]} ${year}`;
            
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const startDay = firstDay === 0 ? 6 : firstDay - 1;
            
            let calendarHTML = '';
            
            for (let i = 0; i < startDay; i++) {
                calendarHTML += '<div class="calendar-day empty"></div>';
            }
            
            for (let day = 1; day <= daysInMonth; day++) {
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const map = currentQuizType === 'dainik' ? dateBinMap : sujasDateBinMap;
                const hasQuiz = map[dateStr] ? true : false;
                const isSelected = selectedDate.getFullYear() === year && 
                                  selectedDate.getMonth() === month && 
                                  selectedDate.getDate() === day;
                
                calendarHTML += `
                    <div class="calendar-day ${hasQuiz ? 'has-quiz' : ''} ${isSelected ? 'selected' : ''}" 
                         onclick="selectModalDate(${year}, ${month}, ${day})">
                        <span class="day-number">${day}</span>
                        ${hasQuiz ? '<span class="quiz-indicator">üìù</span>' : ''}
                    </div>
                `;
            }
            
            document.getElementById('modalCalendarDays').innerHTML = calendarHTML;
        }

        function changeModalMonth(delta) {
            currentModalDate.setMonth(currentModalDate.getMonth() + delta);
            renderModalCalendar();
        }

        function selectModalDate(year, month, day) {
            selectedDate = new Date(year, month, day);
            renderModalCalendar();
        }

        function confirmDateSelection() {
            updateSelectedDateDisplay();
            closeCalendarModal();
            loadQuizForSelectedDate();
        }

        function loadQuizForSelectedDate() {
            const dateStr = formatDate(selectedDate);
            const map = currentQuizType === 'dainik' ? dateBinMap : sujasDateBinMap;
            
            if (map[dateStr]) {
                loadQuizByDate(dateStr);
            } else {
                document.getElementById('questionsList').innerHTML = `
                    <div class="error-message">
                        üìÖ ${selectedDate.toLocaleDateString('hi-IN', { year: 'numeric', month: 'long', day: 'numeric' })} ‡§ï‡•á ‡§≤‡§ø‡§è 
                        ${currentQuizType === 'dainik' ? '‡§¶‡•à‡§®‡§ø‡§ï' : '‡§∏‡•Å‡§ú‡§∏'} ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§
                    </div>
                `;
                document.getElementById('quizDate').textContent = '';
                document.getElementById('questionCount').textContent = '0 ‡§™‡•ç‡§∞‡§∂‡•ç‡§®';
            }
        }

        async function loadQuizByDate(date) {
            const map = currentQuizType === 'dainik' ? dateBinMap : sujasDateBinMap;
            const binId = map[date];
            
            if (!binId) return;

            document.getElementById('questionsList').innerHTML = '<div class="loading"><div class="spinner"></div><div>‚è≥ ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div></div>';

            try {
                const response = await fetch(`${JSONBIN_CONFIG.apiUrl}/b/${binId}/latest`, {
                    headers: { 'X-Master-Key': JSONBIN_CONFIG.masterKey }
                });

                if (!response.ok) {
                    throw new Error('‡§ï‡•ç‡§µ‡§ø‡§ú ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø');
                }

                const data = await response.json();
                const quizData = data.record.quiz;

                if (quizData && quizData.length > 0) {
                    currentQuiz = quizData;
                    userAnswers = new Array(currentQuiz.length).fill(null);
                    displayQuestions(currentQuiz);
                    
                    document.getElementById('questionCount').textContent = `${currentQuiz.length} ‡§™‡•ç‡§∞‡§∂‡•ç‡§®`;
                    document.getElementById('quizDate').textContent = 
                        new Date(date).toLocaleDateString('hi-IN', { year: 'numeric', month: 'long', day: 'numeric' });
                }
            } catch (error) {
                document.getElementById('questionsList').innerHTML = `<div class="error-message">‚ùå ${error.message}</div>`;
            }
        }

        async function loadAllBins() {
            try {
                // Load Dainik Quiz bins
                await loadMasterBin(JSONBIN_CONFIG.masterBinId, 'dainik');
                
                // Load Sujas Quiz bins
                await loadMasterBin(JSONBIN_CONFIG.sujasMasterBinId, 'sujas');
                
            } catch (error) {
                console.log('Error loading bins:', error);
            }
        }

        async function loadMasterBin(binId, type) {
            try {
                const response = await fetch(`${JSONBIN_CONFIG.apiUrl}/b/${binId}/latest`, {
                    headers: { 'X-Master-Key': JSONBIN_CONFIG.masterKey }
                });

                if (response.ok) {
                    const data = await response.json();
                    if (type === 'dainik') {
                        if (data.record && data.record.dateMap) dateBinMap = data.record.dateMap;
                        if (data.record && data.record.bins) allBins = data.record.bins;
                    } else {
                        if (data.record && data.record.dateMap) sujasDateBinMap = data.record.dateMap;
                        if (data.record && data.record.bins) sujasAllBins = data.record.bins;
                    }
                } else {
                    // Create new master bin if it doesn't exist
                    await createMasterBin(binId, type);
                }
            } catch (error) {
                console.log(`Error loading ${type} master bin:`, error);
                // Try to create it
                await createMasterBin(binId, type);
            }
        }

        async function createMasterBin(binId, type) {
            try {
                const initialData = {
                    dateMap: {},
                    bins: [],
                    lastUpdated: new Date().toISOString(),
                    type: type
                };

                const response = await fetch(`${JSONBIN_CONFIG.apiUrl}/b/${binId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Master-Key': JSONBIN_CONFIG.masterKey
                    },
                    body: JSON.stringify(initialData)
                });

                if (response.ok) {
                    console.log(`Created ${type} master bin:`, binId);
                    if (type === 'dainik') {
                        dateBinMap = {};
                        allBins = [];
                    } else {
                        sujasDateBinMap = {};
                        sujasAllBins = [];
                    }
                }
            } catch (error) {
                console.log(`Error creating ${type} master bin:`, error);
            }
        }

        function displayQuestions(questions) {
            let html = '';
            questions.forEach((q, index) => {
                const questionClass = currentQuizType === 'sujas' ? 'question-item sujas' : 'question-item';
                html += `
                    <div class="${questionClass}">
                        <span class="category-tag">${q.category || (currentQuizType === 'dainik' ? '‡§ï‡§∞‡§Ç‡§ü ‡§Ö‡§´‡•á‡§Ø‡§∞‡•ç‡§∏' : '‡§∏‡•Å‡§ú‡§∏ ‡§∏‡•ç‡§™‡•á‡§∂‡§≤')}</span>
                        <div class="question-text">${index + 1}. ${q.question}</div>
                        <div class="options">
                            ${q.options.map((opt, i) => `
                                <div class="option" onclick="selectOption(${index}, ${i}, ${q.correct})" id="opt-${index}-${i}">
                                    ${String.fromCharCode(65 + i)}. ${opt}
                                </div>
                            `).join('')}
                        </div>
                        <div class="explanation" id="exp-${index}">
                            <strong>‚úì ‡§∏‡§π‡•Ä ‡§â‡§§‡•ç‡§§‡§∞:</strong> ${String.fromCharCode(65 + q.correct)}. ${q.options[q.correct]}<br>
                            <strong>üìå ‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ:</strong> ${q.explanation || '‡§ï‡•ã‡§à ‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ ‡§®‡§π‡•Ä‡§Ç'}
                        </div>
                    </div>
                `;
            });
            document.getElementById('questionsList').innerHTML = html;
        }

        function selectOption(questionIndex, optionIndex, correctIndex) {
            // Remove previous selections
            for (let i = 0; i < 4; i++) {
                const opt = document.getElementById(`opt-${questionIndex}-${i}`);
                if (opt) {
                    opt.classList.remove('selected-correct', 'selected-wrong');
                }
            }

            const selectedOpt = document.getElementById(`opt-${questionIndex}-${optionIndex}`);
            const correctOpt = document.getElementById(`opt-${questionIndex}-${correctIndex}`);

            if (selectedOpt) {
                if (optionIndex === correctIndex) {
                    selectedOpt.classList.add('selected-correct');
                } else {
                    selectedOpt.classList.add('selected-wrong');
                    if (correctOpt) {
                        correctOpt.classList.add('selected-correct');
                    }
                }
            }

            // Show explanation
            const explanation = document.getElementById(`exp-${questionIndex}`);
            if (explanation) {
                explanation.classList.add('show');
            }
        }

        // Admin Functions
        function openAdminModal() {
            document.getElementById('adminModal').classList.add('active');
        }

        function closeAdminModal() {
            document.getElementById('adminModal').classList.remove('active');
        }

        function verifyAdmin() {
            const password = document.getElementById('modalPassword').value;
            if (password === JSONBIN_CONFIG.adminPassword) {
                isAdmin = true;
                closeAdminModal();
                document.getElementById('adminLoginForm').style.display = 'none';
                document.getElementById('adminControls').style.display = 'block';
                alert('‚úÖ ‡§è‡§°‡§Æ‡§ø‡§® ‡§≤‡•â‡§ó‡§ø‡§® ‡§∏‡§´‡§≤!');
            } else {
                alert('‚ùå ‡§ó‡§≤‡§§ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°');
            }
        }

        function logoutAdmin() {
            isAdmin = false;
            document.getElementById('adminLoginForm').style.display = 'flex';
            document.getElementById('adminControls').style.display = 'none';
            document.getElementById('generateSection').style.display = 'none';
            document.getElementById('shareSection').style.display = 'none';
            document.getElementById('jsonInput').readOnly = true;
        }

        function showEditMode() {
            document.getElementById('generateSection').style.display = 'block';
            document.getElementById('quizDateInput').value = formatDate(selectedDate);
            document.getElementById('editQuizType').value = currentQuizType;
            
            // Load current quiz if exists for selected date
            const dateStr = formatDate(selectedDate);
            const map = currentQuizType === 'dainik' ? dateBinMap : sujasDateBinMap;
            
            if (map[dateStr]) {
                loadQuizJSONForEdit(dateStr);
            } else {
                document.getElementById('jsonInput').value = JSON.stringify(
                    currentQuizType === 'dainik' ? defaultQuiz : defaultSujasQuiz, 
                    null, 2
                );
            }
        }

        async function loadQuizJSONForEdit(date) {
            const map = currentQuizType === 'dainik' ? dateBinMap : sujasDateBinMap;
            const binId = map[date];
            if (!binId) return;

            try {
                const response = await fetch(`${JSONBIN_CONFIG.apiUrl}/b/${binId}/latest`, {
                    headers: { 'X-Master-Key': JSONBIN_CONFIG.masterKey }
                });

                if (!response.ok) {
                    throw new Error('Failed to load quiz');
                }

                const data = await response.json();
                document.getElementById('jsonInput').value = JSON.stringify(data.record, null, 2);
            } catch (error) {
                alert('‚ùå ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ' + error.message);
            }
        }

        function editJSON() {
            if (!isAdmin) {
                alert('‚ùå ‡§ï‡•á‡§µ‡§≤ ‡§è‡§°‡§Æ‡§ø‡§® ‡§π‡•Ä JSON ‡§è‡§°‡§ø‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç!');
                return;
            }
            document.getElementById('jsonInput').readOnly = false;
            document.getElementById('jsonInput').focus();
            document.getElementById('jsonInput').style.backgroundColor = '#fff';
            alert('‚úèÔ∏è ‡§Ö‡§¨ ‡§Ü‡§™ JSON ‡§è‡§°‡§ø‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç');
        }

        function formatJSON() {
            try {
                const jsonText = document.getElementById('jsonInput').value.trim();
                if (jsonText) {
                    const jsonObj = JSON.parse(jsonText);
                    document.getElementById('jsonInput').value = JSON.stringify(jsonObj, null, 2);
                }
            } catch (error) {
                alert('‚ùå Invalid JSON: ' + error.message);
            }
        }

        function loadSampleJSON() {
            const quizType = document.getElementById('editQuizType').value;
            document.getElementById('jsonInput').value = JSON.stringify(
                quizType === 'dainik' ? defaultQuiz : defaultSujasQuiz, 
                null, 2
            );
            document.getElementById('jsonInput').readOnly = false;
        }

        function copyShareUrl() {
            const url = document.getElementById('shareUrl');
            url.select();
            document.execCommand('copy');
            
            const msg = document.createElement('div');
            msg.className = 'copy-message';
            msg.textContent = '‚úÖ URL ‡§ï‡•â‡§™‡•Ä ‡§π‡•ã ‡§ó‡§Ø‡§æ!';
            document.body.appendChild(msg);
            setTimeout(() => msg.remove(), 2000);
        }

        // Save Quiz Function
        async function saveQuizToJSONBin() {
            if (!isAdmin) {
                alert('‚ùå ‡§ï‡•á‡§µ‡§≤ ‡§è‡§°‡§Æ‡§ø‡§® ‡§π‡•Ä ‡§∏‡•á‡§µ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç!');
                return;
            }

            try {
                const jsonText = document.getElementById('jsonInput').value.trim();
                const quizDate = document.getElementById('quizDateInput').value;
                const quizType = document.getElementById('editQuizType').value;
                
                if (!jsonText || !quizDate) {
                    alert('‚ùå JSON ‡§î‡§∞ ‡§§‡§æ‡§∞‡•Ä‡§ñ ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§≠‡§∞‡•á‡§Ç!');
                    return;
                }

                // Validate JSON
                let quizData;
                try {
                    quizData = JSON.parse(jsonText);
                } catch (e) {
                    alert('‚ùå Invalid JSON format: ' + e.message);
                    return;
                }

                if (!quizData.quiz || !Array.isArray(quizData.quiz)) {
                    alert('‚ùå JSON ‡§Æ‡•á‡§Ç "quiz" array ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è');
                    return;
                }

                // Validate quiz structure
                for (let i = 0; i < quizData.quiz.length; i++) {
                    const q = quizData.quiz[i];
                    if (!q.question || !q.options || !Array.isArray(q.options) || q.options.length < 2) {
                        alert(`‚ùå ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ${i+1} ‡§Æ‡•á‡§Ç options ‡§∏‡§π‡•Ä ‡§∏‡•á ‡§®‡§π‡•Ä‡§Ç ‡§≠‡§∞‡•á ‡§π‡•à‡§Ç`);
                        return;
                    }
                    if (q.correct === undefined || q.correct < 0 || q.correct >= q.options.length) {
                        alert(`‚ùå ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ${i+1} ‡§Æ‡•á‡§Ç correct index ‡§∏‡§π‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à`);
                        return;
                    }
                }

                const masterBinId = quizType === 'dainik' ? JSONBIN_CONFIG.masterBinId : JSONBIN_CONFIG.sujasMasterBinId;
                const map = quizType === 'dainik' ? dateBinMap : sujasDateBinMap;
                const bins = quizType === 'dainik' ? allBins : sujasAllBins;

                let binId = map[quizDate];
                let response;

                const saveData = {
                    quiz: quizData.quiz,
                    updated: new Date().toISOString(),
                    date: quizDate,
                    quizType: quizType
                };

                if (binId) {
                    // Update existing quiz
                    response = await fetch(`${JSONBIN_CONFIG.apiUrl}/b/${binId}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Master-Key': JSONBIN_CONFIG.masterKey
                        },
                        body: JSON.stringify(saveData)
                    });
                } else {
                    // Create new quiz
                    response = await fetch(`${JSONBIN_CONFIG.apiUrl}/b`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Master-Key': JSONBIN_CONFIG.masterKey
                        },
                        body: JSON.stringify(saveData)
                    });
                }

                if (!response.ok) {
                    throw new Error('JSONBin API error: ' + response.status);
                }

                const data = await response.json();
                const newBinId = binId || data.metadata.id;

                if (!binId) {
                    bins.push({ binId: newBinId, date: quizDate });
                }
                map[quizDate] = newBinId;

                // Update master bin with retry logic
                let masterUpdated = false;
                let retryCount = 0;
                const maxRetries = 3;

                while (!masterUpdated && retryCount < maxRetries) {
                    try {
                        const masterData = {
                            dateMap: map,
                            bins: bins,
                            lastUpdated: new Date().toISOString(),
                            type: quizType
                        };

                        const masterResponse = await fetch(`${JSONBIN_CONFIG.apiUrl}/b/${masterBinId}`, {
                            method: 'PUT',
                            headers: {
                                'Content-Type': 'application/json',
                                'X-Master-Key': JSONBIN_CONFIG.masterKey
                            },
                            body: JSON.stringify(masterData)
                        });

                        if (masterResponse.ok) {
                            masterUpdated = true;
                        } else {
                            retryCount++;
                            if (retryCount < maxRetries) {
                                await new Promise(resolve => setTimeout(resolve, 1000)); // Wait 1 second before retry
                            }
                        }
                    } catch (error) {
                        retryCount++;
                        if (retryCount < maxRetries) {
                            await new Promise(resolve => setTimeout(resolve, 1000));
                        }
                    }
                }

                if (!masterUpdated) {
                    // If master update fails, try to create it
                    try {
                        const masterData = {
                            dateMap: map,
                            bins: bins,
                            lastUpdated: new Date().toISOString(),
                            type: quizType
                        };

                        const createResponse = await fetch(`${JSONBIN_CONFIG.apiUrl}/b/${masterBinId}`, {
                            method: 'PUT',
                            headers: {
                                'Content-Type': 'application/json',
                                'X-Master-Key': JSONBIN_CONFIG.masterKey
                            },
                            body: JSON.stringify(masterData)
                        });

                        if (createResponse.ok) {
                            masterUpdated = true;
                        }
                    } catch (error) {
                        console.log('Failed to create master bin:', error);
                    }
                }

                // Show share section even if master update failed
                document.getElementById('shareSection').style.display = 'block';
                document.getElementById('quizId').textContent = newBinId;
                document.getElementById('shareUrl').value = 
                    window.location.origin + window.location.pathname + '?type=' + quizType + '&date=' + quizDate;
                
                if (masterUpdated) {
                    alert(`‚úÖ ${quizType === 'dainik' ? '‡§¶‡•à‡§®‡§ø‡§ï' : '‡§∏‡•Å‡§ú‡§∏'} ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§∏‡•á‡§µ ‡§π‡•ã ‡§ó‡§Ø‡§æ!`);
                } else {
                    alert(`‚ö†Ô∏è ‡§ï‡•ç‡§µ‡§ø‡§ú ‡§∏‡•á‡§µ ‡§π‡•ã ‡§ó‡§Ø‡§æ ‡§≤‡•á‡§ï‡§ø‡§® master bin update ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§π‡•Å‡§à‡•§ Quiz ID: ${newBinId}`);
                }
                
                // Refresh calendar
                renderModalCalendar();
                
                // Reload quiz if it's the selected date and type
                if (quizDate === formatDate(selectedDate) && quizType === currentQuizType) {
                    loadQuizByDate(quizDate);
                }

            } catch (error) {
                alert('‚ùå Error: ' + error.message);
            }
        }

        window.addEventListener('load', initialize);
    </script>
</body>
</html>
